# right-moves

## Dependencies

- This is compiled using [Jekyll](https://jekyllrb.com/), in order to create a single static HTML file that contains all slides from webflow without requiring us to use some sort of iframe option. To install that, follow the directions found on its website. 
- The original generated design is from [Webflow](https://webflow.com/). John should have more info about this. 

## Directory Structure

To get an in-depth look at the directory structure of a general [jekyll site go here](https://jekyllrb.com/docs/structure/).

1. 	root directory
	* README.md 
		- You are here.
	* index.html 
		- Contains the _include/ html files that are merged in, with the variables on each entry that will be used within that _include file. Will be merged into _layouts/default.html
	* index_working.html
		- As noted below, the last three includes are currently causing the resulting page to be buggy. I have, therefore created a file that should work without those more major glitches (still has the voucher glitch, etc), here. 
	* include_list.html
		- list of includes that can be added/removed to index.html. Backup include list 
	* _config.yml
		- Contains meta data for jekyll. Read more detailed info [here](https://jekyllrb.com/docs/configuration/).
2.	_layout/
	* The _layouts/ folder is the Jekyll folder that contains layouts for any type of page within a jekyll site. 
	* default.html		
		- All CSS and JS should be linked here. **Any library you want to link should be added or removed from here.**
		- Jekyll merges in the markup from the index.html file here. 
3.	_site/
	* This is the folder that is generated by Jekyll and holds the merged static webpages. You do not need to add or subtract anything from it, as it should automatically update. 
4. _includes/ 
	* All html files taken from assets/ and edited down to be injected into index.html. They have had the metadata and js removed, leaving only the `div class="div-container">` with an added id that corresponds to the name of the particular slide. 
	* In each of these files, any unique `data-ix` animation call, is edited to include the id of the slide. Any selector class defined in that animation call (find this in the webflow.js json), is also edited in the include file to contain a unique class, defined as `t-{{include.id}}` which gets transformed in the final product to something like `t-SLIDENAME`. 
5. js/
	* webflow.js 
		- script from webflow that contains all of the default animations in a json that is after `Webflow.require('ix')`. **This has been edited to include newly added animations for each unique page. See more info below.
	* script.js
		- script that has any of our added custon js. Currently, only a jquery function that adjusts z-index on each slide when it is clicked forward.
	* lib/ 
		- various scripts and libraries you may need. 
6. css/	
	* All of the default styles recieved from webflow.
	* addionalStyles.css
		- custom css that I've added.  
7. assets/
	* The original files recieved from webflow's export that we have moved into includes/, css/, js/, images/, and fonts/.

## Installation

- Build the Jekyll _site/ folder by running jekyll build in your directory. I recommend running `jekyll build --watch`, which automatically rebuilds your _site folder whenever you change something in the repository. More on this on jekyll's website.
- Run the jekyll server by running `jekyll serve`. You can now see your page at `http://localhost:4000/`
- **To view the original functioning design, go to `http://localhost:4000/assets/`**. This is useful for seeing and understanding how the design is meant to look. 

## Completed Work
- I added each slide to the `index.html`, using the following steps. 
- I edited each slide to have a unique ID and unique links to next slides (steps below). 
- I edited each of the (non-onload) animations within each slide to have a unique id affixed, so that they would ONLY be triggered within each slide. 

### adding an _include file to the index.html

- Find the slide in `/assets/SLIDENAME.html`. 
- inside the SLIDENAME.html find and copy the div that cointains the class name `div-container` into a new file. 
- Save to `_includes/SLIDENAME.html`
- give this `div-container` a unique id using the include id, using `id="{{ include.id }}"`. 
- whatever `<a>` or button items exist in the original to send you to the next slide, remove their `href` and instead give them a `class=move-button` and a value of `next="{{ include.next1 }}"` where the `next1` is whatever page id you want it to go to. Note that next1, next2, next3 are the options, as defined in the `{% include SLIDENAME.html id="SLIDENAME" next1="NEXTSLIDE1" next2="NEXTSLIDE2" %}` entry in the `index.html`. 
- See next section for how to edit the animations to make them unique. 

### How I set up each page’s animations with unique animation ids/selectors:
* Find each element with data-ix=“SOMENAME”, 
* Find animation “SOMENAME" in webflow.js
    * Copy that json entry and paste below the original. 
    * Change its slug and name to `“SOMENAME-currentpage”` (<-whatever the include id is for that page).
    * Change selector to to `“SOMECLASS.t-currentpage"` (<-whatever the include id is for that page).
    * In the current _include html page 
        * change the data-ix name to `data-ix=“SOMENAME-{{ include.id }}”` 
        * Find the DOM element with the SOMECLASS class, and add the following class, `t-{{ include.id }}`
* NOTE: some of the elements with data-ix will not be functional. I think this is an artifact of some interaction that John may have abandoned. They are partially listed below. 
* NOTE: data-ix elements and their corresponding selector elements will NOT be the same elements but they will be in the same _include
* NOTE: if there is no selector, just copy JSON entry and append the include id
* NOTE: anything with trigger type=LOAD is changed at the moment. 

## To Do (in rough order of importance)

- Fix the errors related to the last three _include/ files (see known issues). 
- Fix voucher style errors (see known issues)
- Add remaining copy into the slides that don't have the complete copy. Emily should know where to find this final copy.
- Edit all clickable items to have `cursor:pointer` styles.
- Add in links to the `/_includes/conclusion.html` file.
- Make all "buttons" move up and down on hover
- Fix resize issues (see below)
- Other style changes
- Figure out how to publish the _site folder to apps-staging
- circulate to John, Maya, et al.
- uncomment google tag/analytics/etc
- get metas and shares from Nicole
- Publish

### Possible enhancements?

- It may be preferable to "load" or display each slide on the advancement to that slide, rather than the current solution which just moved it up in the z-index. For some reason, the display: none vs. display: block option was not working with the webflow but changing the z-index was. 

## Known Issues

### Big Picture

- It is unknown to me (Dan), how or if we need to attribute Webflow since we are more or less using large parts of the code that it generated. 
- animations for new scenes happen on load, not on reveal. They should happen on reveal as in the design. **I haven't edited these animations at all in the `webflow.js` file.** They contain `"type":"load",` in their json entry. My suggestion is that their `data-ix` animation entry is found with the json, and some custom js is added to `script.js` to trigger these defined styles on click forward. Some sort of index will need to be created, which tracks which "slide" is being triggered or un-triggered. 
- **If you comment out _include files in the `index.html` file, Jekyll does not appear to respect that. In order to remove include calls, you must delete them (temporarily) from `index.html`. This is why I have a backup of the include call markup in `include_list.html`**. 
- Voucher styles/animations are not being correctly called by the webflow default. I have done a good amount of troubleshooting, trying to figure out what's going on, and I can't pinpoint it. Rather than fixing within the webflow js framework, my suggestion is to trigger each voucher slide in/out with some custom jquery work. If you did this, I would suggest removing the voucher data-ix calls on each of those outcome html pages. 
- It appears that the reduction in "points" is incorrect across all outcome htmls. It is the same in every one which seems incorrect. I would guess this is because John put in placeholder information rather than the actual "point"/"score" reduction. 


### Specific

- Choice 3's last right arrow appears to be missing for some reason. I believe this means that for some reason, the `next-scene-trigger-scenario3` animation is not correctly being triggered. It could also have something to do with the corresponding trigger, which is found on the `.arrow-right-last.t-scenario3` div. 
- Possibly related or possibly not, the `outcome3a.html`, `outcome3b.html`, and `conclusion.html` includes appear to be causing rendering/load issues within the rest of the page. I haven't been able to troubleshoot it yet, unfortunately. But I can say that similar issues were caused, previously, when `data-ix` animation calls were not made specific to the page. In other words, it was happening when a `data-ix` call was causing multiple selectors to be triggered. 
	- My suggestion for how to start troubleshooting this would be to start by recreating the _include file for each of these three pages, as well as the `data-ix` entries in the `webflow.js` json of animations. It is possible that there are errors within the current set up that I am having trouble seeing. 
	- Additionally, I would test if these files are placed early in the sequence, if they would still cause the same problems. 

## Webflow Animations that appear to not be functioning or called. 

At the end of the project, it may make sense to remove these from the html of the includes, since we don't really know why they're there and what they are doing. My belief is that they're artifacts of some other part of John's design proces. He might have info if you explain to him where its happening. 

* In all pages, any of these appear to not be functioning
    * next-btn-load
    * car-appear
    * dramatic-pause
    * illustration-hider
* introduction.html
    * data-ix="ans02-hide-fam”
    * data-ix="buildings-out”
    * data-ix="hide-score”
* Outcome1a.html, outcome2a.html
    * ans02-hide-fam
    * next-btn-load (load)




